(this["webpackJsonpzh-TW.2021.plastics.plastic_policy.signup"]=this["webpackJsonpzh-TW.2021.plastics.plastic_policy.signup"]||[]).push([[0],{16:function(e,a,n){"use strict";n.r(a);n(7),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var t=n(2),o=n.n(t),r=n(5),i=(n(9),n(10)),s=n(11),c=window,l=c.$,p=(c.dataLayer,c.currency);function u(){return(u=Object(r.a)(o.a.mark((function e(){var a,n,t,r,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=2e4,l("#petition-goal").html(p(a,{precision:0,separator:","}).format()),n=2737,e.prev=3,e.next=6,fetch("https://act.greenpeace.org/page/widget/713556");case 6:return t=e.sent,e.next=9,t.json();case 9:r=e.sent,n=r.data.rows.map((function(e){return parseInt(e.columns[4].value)})).reduce((function(e,a){return e+a}),0),l("#petition-count").html(p(n,{precision:0,separator:","}).format()),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),console.log(e.t0);case 17:i=n/a,new s.Line("#progress-bar",{strokeWidth:3,easing:"easeInOut",duration:1400,color:"#FFEA82",trailColor:"#eee",trailWidth:1,svgStyle:{width:"100%",height:"100%"}}).animate(i);case 20:case"end":return e.stop()}}),e,null,[[3,14]])})))).apply(this,arguments)}l(document).ready((function(){console.log("ready!"),function(){u.apply(this,arguments)}(),function(){var e=(new Date).getFullYear();l("#fake_supporter_birthYear").append('<option value="">\u51fa\u751f\u5e74\u4efd</option>');for(var a=0;a<80;a++){var n='<option value="01/01/'.concat(e-a,'">').concat(e-a,"</option>");l("#fake_supporter_birthYear").append(n),l("#en__field_supporter_NOT_TAGGED_6").append(n)}}(),f(),function(){var e=function(){var e="FRESH";e=2===window.pageJson.pageNumber?"SUCC":"FRESH";return e}();"FRESH"===e?l(".page-2").hide():"SUCC"===e&&(l(".page-1").hide(),l(".page-2").show(),l("section").hide(),l("#home").show())}()}));var f=function(){console.log("init form"),l("#center_sign-submit").click((function(e){e.preventDefault(),l("#fake-form").submit(),console.log("fake-form submitting")})).end(),l.validator.addMethod("email",(function(e,a){return this.optional(a)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+$/i.test(e)}),"Email \u683c\u5f0f\u932f\u8aa4"),l.validator.addMethod("taiwan-phone",(function(e,a){var n=new RegExp(/^(0|886|\+886)?(9\d{8})$/).test(e),t=new RegExp(/^(0|886|\+886){1}[2-8]-?\d{6,8}$/).test(e);return l("#fake_supporter_phone").val()?n||t:(console.log("phone testing"),!0)}),"\u96fb\u8a71\u683c\u5f0f\u4e0d\u6b63\u78ba\uff0c\u8acb\u53ea\u8f38\u5165\u6578\u5b57 0912345678 \u548c 02-23612351"),l.validator.addClassRules({email:{email:!0},"taiwan-phone":{"taiwan-phone":!0}}),l("#fake-form").validate({errorPlacement:function(e,a){console.log(e),a.parents("div.form-field:first").after(e)},submitHandler:function(e){var a=this;l('#mc-form [name="Email"]').value=l("#fake_supporter_emailAddress").val(),l('#mc-form [name="LastName"]').value=l("#fake_supporter_lastName").val(),l('#mc-form [name="FirstName"]').value=l("#fake_supporter_firstName").val(),l('#mc-form [name="MobilePhone"]').value=l("#fake_supporter_phone").val(),l('#mc-form [name="OptIn"]').value=l("#fake_optin").val(),l('#mc-form [name="Birthdate"]').value=i(l("#fake_supporter_birthYear").val()).format("YYYY-MM-DD");var n=new FormData;return l("#mc-form input").forEach((function(e){var a=null;a="checkbox"===e.type?l('#mc-form [name="OptIn"]').value:e.value,n.append(e.name,a)})),fetch(l("#mc-form").action,{method:"POST",body:n}).then((function(e){return e.json()})).then((function(e){e&&(console.log("mc form posted"),console.log("response",e),a.sendPetitionTracking("2021-plastic_retailer"))})).catch((function(e){console.log(e),a.formLoading=!1}))},invalidHandler:function(e,a){var n=a.numberOfInvalids();if(n){console.log(n);l("div.error").show()}else l("div.error").hide()}})};"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},6:function(e,a,n){e.exports=n(16)},7:function(e,a,n){},9:function(e,a,n){}},[[6,1,2]]]);
//# sourceMappingURL=main.23ad4eb2.chunk.js.map