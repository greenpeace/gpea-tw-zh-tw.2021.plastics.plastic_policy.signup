(this["webpackJsonpzh-TW.2021.plastics.plastic_policy.signup"]=this["webpackJsonpzh-TW.2021.plastics.plastic_policy.signup"]||[]).push([[0],{16:function(e,a,o){"use strict";o.r(a);o(7),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var t=o(2),n=o.n(t),i=o(5),r=(o(9),o(10)),s=o(11),p=window,c=p.$,l=(p.dataLayer,p.currency),u="https://www.greenpeace.org/taiwan/?ref=2021-plastic_policy_petition",d="https://supporter.ea.greenpeace.org/tw/s/donate?campaign=plastics&ref=2021-plastic_policy_petition-footer",f="https://www.greenpeace.org/taiwan/policies/privacy-and-cookies/?ref=2021-plastic_policy_petition";function m(){return(m=Object(i.a)(n.a.mark((function e(){var a,o,t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=parseInt(c('#mc-form [name="numResponses"]').val()),console.log(a),o=5e3*Math.ceil(a/5e3),console.log(o),c("#petition-goal").html(l(o,{precision:0,separator:","}).format()),c("#petition-count").html(l(a,{precision:0,separator:","}).format()),t=a/o,new s.Line("#progress-bar",{strokeWidth:3,easing:"easeInOut",duration:1400,color:"#FFEA82",trailColor:"#eee",trailWidth:1,svgStyle:{width:"100%",height:"100%"}}).animate(t);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}window.directTo=function(e){switch(e){case"main":window.open(u,"_blank");break;case"donate":window.open(d,"_blank");break;case"privacy":window.open(f,"_blank");break;default:window.open(f,"_blank")}},c(document).ready((function(){console.log("ready!"),function(){m.apply(this,arguments)}(),function(){var e=(new Date).getFullYear();c("#fake_supporter_birthYear").append('<option value="">\u51fa\u751f\u5e74\u4efd</option>');for(var a=0;a<80;a++){var o='<option value="01/01/'.concat(e-a,'">').concat(e-a,"</option>");c("#fake_supporter_birthYear").append(o),c("#en__field_supporter_NOT_TAGGED_6").append(o)}}(),h(),function(){var e=function(){var e="FRESH";e=2===window.pageJson.pageNumber?"SUCC":"FRESH";return e}();"FRESH"===e?c(".page-2").hide():"SUCC"===e&&(c(".page-1").hide(),c(".page-2").show(),c("section").hide(),c("#home").show());c(".loading-cover").fadeOut(),c(window).scroll((function(){c(this).scrollTop()>100&&c(this).scrollTop()<c("#speakers").offset().top?c(".parallax-bg").show():c(".parallax-bg").hide()}))}()}));var h=function(){console.log("init form"),c("#center_sign-submit").click((function(e){e.preventDefault(),c("#fake-form").submit(),console.log("fake-form submitting")})).end(),c.validator.addMethod("email",(function(e,a){return this.optional(a)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+$/i.test(e)}),"Email \u683c\u5f0f\u932f\u8aa4"),c.validator.addMethod("taiwan-phone",(function(e,a){var o=new RegExp(/^(0|886|\+886)?(9\d{8})$/).test(e),t=new RegExp(/^(0|886|\+886){1}[2-8]-?\d{6,8}$/).test(e);return c("#fake_supporter_phone").val()?o||t:(console.log("phone testing"),!0)}),"\u96fb\u8a71\u683c\u5f0f\u4e0d\u6b63\u78ba\uff0c\u8acb\u53ea\u8f38\u5165\u6578\u5b57 0912345678 \u548c 02-23612351"),c.validator.addClassRules({email:{email:!0},"taiwan-phone":{"taiwan-phone":!0}}),c("#fake-form").validate({errorPlacement:function(e,a){console.log(e),a.parents("div.form-field:first").after(e)},submitHandler:function(e){var a=this;c('#mc-form [name="Email"]').val(c("#fake_supporter_emailAddress").val()),c('#mc-form [name="LastName"]').val(c("#fake_supporter_lastName").val()),c('#mc-form [name="FirstName"]').val(c("#fake_supporter_firstName").val()),c('#mc-form [name="MobilePhone"]').val(c("#fake_supporter_phone").val()),c('#mc-form [name="OptIn"]').val(c("#fake_optin").prop("checked")),c('#mc-form [name="Birthdate"]').val(r(c("#fake_supporter_birthYear").val()).format("YYYY-MM-DD"));var o=new FormData;return Object.keys(c("#mc-form input")).forEach((function(e){var a=c("#mc-form input")[e],t=null;t="checkbox"===a.type?c("#fake_optin").prop("checked"):a.value,o.append(a.name,t)})),c(".loading-cover").fadeIn(),fetch(c("#mc-form").attr("action"),{method:"POST",body:o}).then((function(e){if(c(".loading-cover").fadeOut(),e.ok)return e.json();throw{ok:e.ok,status:e.status,statusText:e.statusText,type:e.type}})).then((function(e){var a,o;e&&(console.log("mc form posted"),console.log("response",e),window.pageJson.pageNumber=2,c(".page-1").hide(),c(".page-2").show(),u+="_tkpage",d+="_tkpage",f+="_tkpage",a="2021-plastic_policy",window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"gaEvent",eventCategory:"petitions",eventAction:"signup",eventLabel:a,eventValue:o}),window.dataLayer.push({event:"fbqEvent",contentName:a,contentCategory:"Petition Signup"}),window.uetq=window.uetq||[],window.uetq.push("event","signup",{event_category:"petitions",event_label:a,event_value:0}))})).catch((function(e){console.log(e),a.formLoading=!1}))},invalidHandler:function(e,a){var o=a.numberOfInvalids();if(o){console.log(o);c("div.error").show()}else c("div.error").hide()}})};"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},6:function(e,a,o){e.exports=o(16)},7:function(e,a,o){},9:function(e,a,o){}},[[6,1,2]]]);
//# sourceMappingURL=main.f3c22b87.chunk.js.map